{"content": "<p>Les balises d&rsquo;entit\u00e9s (ETAG) sont un m\u00e9canisme que les serveurs web et les navigateurs utilisent pour d\u00e9terminer si le composant dans le cache du navigateur correspond \u00e0 celui sur le serveur d&rsquo;origine (Une \u00abentit\u00e9\u00bb est un autre mot pour d\u00e9signer un \u00abcomposant\u00bb : image, script, feuille de style, etc). Les ETags ont \u00e9t\u00e9 ajout\u00e9s pour fournir un m\u00e9canisme de validation des entit\u00e9s qui est plus souple que la date de derni\u00e8re modification. Un ETag est une cha\u00eene qui identifie de mani\u00e8re unique une version sp\u00e9cifique d&rsquo;un composant. Les seules contraintes de format sont que la cha\u00eene soit indiqu\u00e9e entre guillements. Le serveur d&rsquo;origine sp\u00e9cifie le ETag du composant en utilisant <code>ETag</code> dans l&rsquo;en-t\u00eate de r\u00e9ponse.</p><pre><code>HTTP/1.1 200 OKLast-Modified: Tue, 12 Dec 2006 03:03:59 GMTETag: &quot;10c24bc-4ab-457e1c1f&quot;Content-Length: 12195</code></pre><p>Plus tard, si le navigateur doit valider un composant, il utilise l&rsquo;en-t\u00eate <code>If-None-Match</code> pour passer le ETag vers le serveur d&rsquo;origine. Si les ETags correspondent, un code de statut 304 est renvoy\u00e9, \u00e9conomisant 12 195 octets dans la r\u00e9ponse pour cet exemple.</p><pre><code>GET /i/yahoo.gif HTTP/1.1Host: us.yimg.comIf-Modified-Since: Tue, 12 Dec 2006 03:03:59 GMTIf-None-Match: &quot;10c24bc-4ab-457e1c1f&quot;HTTP/1.1 304 Not Modified</code></pre><p>Le probl\u00e8me avec les ETags est qu&rsquo;ils sont g\u00e9n\u00e9ralement construits en utilisant des attributs qui les rendent uniques \u00e0 un serveur, unique \u00e0 l&rsquo;h\u00e9bergement d&rsquo;un site. Les ETags ne correspondent pas lorsqu&rsquo;un navigateur obtient le composant d&rsquo;origine d&rsquo;un serveur et essaie de valider ce composant sur \u200b\u200bun serveur diff\u00e9rent, une situation tr\u00e8s fr\u00e9quente sur \u200b\u200bles sites Web qui utilisent un cluster de serveurs pour traiter les demandes. Par d\u00e9faut, Apache et IIS int\u00e9grent les donn\u00e9es dans le ETag, ce qui r\u00e9duit consid\u00e9rablement les chances de r\u00e9ussite des tests de validit\u00e9 sur les sites Web avec plusieurs serveurs.</p><p>Le format ETag pour Apache 1.3 et 2.x est <code>inode-size-timestamp</code>. M\u00eame si un fichier peut r\u00e9sider dans le m\u00eame r\u00e9pertoire sur plusieurs serveurs, et avoir la m\u00eame taille, les m\u00eames permissions et le m\u00eame horodatage, son inode est diff\u00e9rent d&rsquo;un serveur \u00e0 un autre.</p><p>IIS 5.0 et 6.0 ont un probl\u00e8me semblable avec ETags. Le format de ETags sur IIS est <code>Filetimestamp:ChangeNumber</code>. <code>ChangeNumber</code> est un compteur utilis\u00e9 pour suivre les changements de configuration de IIS. Il est peu probable que le <code>ChangeNumber</code> soit le m\u00eame sur tous les serveurs IIS derri\u00e8re un site web.</p><p>Le r\u00e9sultat final pour les ETags g\u00e9n\u00e9r\u00e9s par Apache et IIS pour le m\u00eame composant ne correspondent pas d&rsquo;un serveur \u00e0 un autre. Si les ETags ne correspondent pas, l&rsquo;utilisateur ne re\u00e7oit pas la petite et rapide r\u00e9ponse 304 pour lesquels ils ont \u00e9t\u00e9 pr\u00e9vus. Au contraire, ils obtiendront une r\u00e9ponse normale 200 avec toutes les donn\u00e9es pour le composant. Si vous h\u00e9bergez votre site web sur un seul serveur, ce n&rsquo;est pas un probl\u00e8me. Mais si vous avez plusieurs serveurs d&rsquo;h\u00e9bergement pour votre site web, et que vous utilisez Apache ou IIS avec la configuration ETag par d\u00e9faut, les utilisateurs ont des pages plus lentes, vos serveurs ont une charge plus \u00e9lev\u00e9e, vous consommez plus de bande passante, et les proxies ne peuvent mettre en cache votre contenu de mani\u00e8re efficace. M\u00eame si vos composants ont un en-t\u00eate <code>Expire</code> lointain, une requ\u00eate GET conditionnelle est toujours faite \u00e0 chaque fois que l&rsquo;utilisateur appuie sur Recharger ou Actualiser.</p><p>Si vous ne tirez pas parti du mod\u00e8le de validation flexible que les ETags fournissent, il est pr\u00e9f\u00e9rable de simplement retirer les ETag partout. L&rsquo;en-t\u00eate <code>Last-Modified</code> valide sur la base de l&rsquo;horodatage du composant. Retirer les ETag r\u00e9duit \u00e0 la fois la taille des en-t\u00eates HTTP de la r\u00e9ponse et des demandes ult\u00e9rieures. Cet <a href=\"http://support.microsoft.com/?id=922733\">article du support technique Microsoft</a> d\u00e9crit comment supprimer les ETags. Dans Apache, cela se fait simplement en ajoutant la ligne suivante \u00e0 votre fichier de configuration d&rsquo;Apache :</p><pre><code> FileETag none</code></pre>", "id": "yetags", "title": "Configurer les ETags"}