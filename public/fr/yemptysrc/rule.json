{"content": "<p>Il est plus fr\u00e9quent qu&rsquo;on ne le croit de trouver des images avec un attribut <strong>src</strong> vide. Ceci appara\u00eet sous deux formes :</p><ol><li>En HTML</li></ol><pre><code>&lt;img src=&quot;&quot;&gt;</code></pre><ol><li>En JavaScript</li></ol><pre><code>var img = new Image();img.src = &quot;&quot;;</code></pre><p>Les deux formes ont le m\u00eame effet : le navigateur fait une nouvelle demande \u00e0 votre serveur.</p><ul><li><strong>Internet Explorer</strong> fait une demande pour le r\u00e9pertoire dans lequel se trouve la page.</li><li><strong>Safari et Chrome</strong> font la demande \u00e0 la page elle-m\u00eame.</li><li><strong>Firefox</strong> 3 et les versions ant\u00e9rieures se comportent comme Safari et Chrome, mais la version 3.5 a abord\u00e9 cette question dans le rapport de <a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=444931\">[bug 444931]</a> et n&rsquo;envoie donc plus de nouvelle demande.</li><li><strong>Op\u00e9ra</strong> ne fait rien.</li></ul><p><strong>Pourquoi est-ce un mauvais comportement ?</strong></p><ol><li>Paralyse vos serveurs en envoyant une grande quantit\u00e9 de trafic inattendu, surtout pour les pages qui obtiennent des millions de pages vues par jour.</li><li>Perte de puissance de calcul pour g\u00e9n\u00e9rer une page qui ne sera jamais vue.</li><li>Donn\u00e9es de l&rsquo;utilisateur \u00e9ventuellement corrompues. Si vous suivez l&rsquo;\u00e9tat de la requ\u00eate, que ce soit par cookies ou d&rsquo;une autre mani\u00e8re, vous avez la possibilit\u00e9 de d\u00e9truire les donn\u00e9es. M\u00eame si la demande d&rsquo;image ne \u200b\u200brenvoie pas d&rsquo;image, tous les en-t\u00eates sont lus et accept\u00e9s par le navigateur, y compris tous les cookies. Alors que le reste de la r\u00e9ponse est rejet\u00e9e, des d\u00e9g\u00e2ts peuvent d\u00e9j\u00e0 \u00eatre faits.</li></ol><p>La cause de ce comportement est la fa\u00e7on dont la r\u00e9solution URI est effectu\u00e9e dans les navigateurs. Ce comportement est d\u00e9fini dans la RFC 3986 - Uniform Resource Identifiers. Quand une cha\u00eene vide est rencontr\u00e9e comme URI, celle-ci est consid\u00e9r\u00e9e comme un URI relatif et est r\u00e9solu selon l&rsquo;algorithme d\u00e9fini dans la section 5.2. Ce cas particulier est d\u00e9taill\u00e9 \u00e0 la section 5.4. Firefox, Safari et Chrome ont tous r\u00e9solu ce probl\u00e8me de cha\u00eene vide correctement dans leur cahier des charges, alors qu&rsquo;Internet Explorer le r\u00e9sout de fa\u00e7on incorrecte, apparemment selon une version ant\u00e9rieure de la sp\u00e9cification, RFC 2396 - Uniform Resource Identifiers (rendue obsol\u00e8te par la RFC 3986). Ainsi, techniquement, les navigateurs font ce qu&rsquo;ils sont cens\u00e9s faire pour r\u00e9soudre les URI relatifs. Le probl\u00e8me est que dans ce contexte, la cha\u00eene vide est clairement involontaire.</p><p>\u00c0 la section 4.8.2, HTML5 ajoute \u00e0 la description de l&rsquo;attribut src de la balise l&rsquo;indication aux navigateurs de ne pas faire une demande suppl\u00e9mentaire :</p><blockquote><p>L&rsquo;attribut src doit \u00eatre pr\u00e9sent et doit contenir une URL valide de r\u00e9f\u00e9rencement d&rsquo;une image, \u00e9ventuellement anim\u00e9e mais non-interactive, ni pagin\u00e9e ou script\u00e9e. Si l&rsquo;URI de base de l&rsquo;\u00e9l\u00e9ment est la m\u00eame que l&rsquo;adresse du document, alors la valeur de l&rsquo;attribut src ne peut pas \u00eatre une cha\u00eene vide.</p></blockquote><p>Heureusement, les navigateurs n&rsquo;auront plus ce probl\u00e8me \u00e0 l&rsquo;avenir. Malheureusement, il n&rsquo;existe pas de telle clause pour <code>&lt;script src=&quot;&quot;&gt;</code> et <code>&lt;link href=&quot;&quot;&gt;</code>. Peut-\u00eatre qu&rsquo;il est encore temps de faire cet ajustement pour s&rsquo;assurer que les navigateurs n&rsquo;impl\u00e9mentent ce comportement par accident.</p><p>Cette r\u00e8gle a \u00e9t\u00e9 inspir\u00e9e par le gourou JavaScript Yahoo! Nicolas C. Zakas. Pour plus d&rsquo;informations, consultez son article &ldquo;<a href=\"http://www.nczonline.net/blog/2009/11/30/empty-image-src-can-destroy-your-site/\">Empty image src can destroy your site</a>&rdquo;.</p>", "id": "yemptysrc", "title": "\u00c9viter les balises image src vides"}